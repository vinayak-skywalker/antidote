# Working with Salt
## Part 4 - Salt Event bus and Reactor system

One of the features that distinguishes Salt from other configuration management systems is that Salt allows you to build
an event driven infrastructure.

Salt uses a high-speed ZeroMQ event bus to facilitate secure communication between the Salt Master and the Salt minions.
An example of this is when the Salt Master executes a remote command on a target minion, an event is generated and published 
on the event bus. The Salt minion is subscribed to the event bus and when it sees this event, it will automatically execute 
this command locally. Since all the minions are listening to the event bus, it is possible to execute a remote command on 
a group/all minions at the same time. This is what makes Salt scalable. An event can be generated by both the Salt Master 
and the Salt minions.

You can fire up the event bus and watch the events using the command,

```
salt -run state.event pretty=True
```
<button type="button" class="btn btn-primary btn-sm" onclick="runSnippetInTab('salt1', 0)">Run this snippet</button>

The Junos Syslog Engine converts real-time syslog messages from the Junos device into Salt events and publishes them onto the Event bus.
This allows us to react to events that are happening on the Junos device. The reactor system has an if-this-then-that format and it matches
event tags with a SaltStack State file. When an event with a particular tag is published on the Event bus, the reactor kicks in and the 
corresponding state file will be executed on the Salt Master. 

Both the Junos Syslog Engine and the reactor are configured as part of the Salt master configuration. To view this,

```
cat /etc/salt/master
```

Here you see that we are matching a commit event from the vQFX to a commit.sls state file. The contents of the commit.sls file is,

```
antidote@antidote$cat /srv/reactor/commit.sls



```
<button type="button" class="btn btn-primary btn-sm" onclick="runSnippetInTab('vqfx1', 2)">Verify Output (Optional)</button>

From the above snippet, the RPC command equivalent for the 'show route' CLI command is 'get-route-information'
Let us now run the junos.rpc command. We can specify a destination file where the output is directed to. The 'terse' keyword allows you to obtain a summary output.

```
salt 'vqfx1' junos.rpc get-route-information /var/tmp/route.xml terse=True
```
<button type="button" class="btn btn-primary btn-sm" onclick="runSnippetInTab('salt1', 3)">Run this snippet</button>

To verify that the output was written to the '/var/tmp/route.xml', execute:
```
cat /var/tmp/route.xml
```
<button type="button" class="btn btn-primary btn-sm" onclick="runSnippetInTab('salt1', 4)">Verify Output (Optional)</button>
